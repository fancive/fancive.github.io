<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>翻译 on home</title>
    <link>http://localhost:1313/tags/%E7%BF%BB%E8%AF%91/</link>
    <description>Recent content in 翻译 on home</description>
    <generator>Hugo</generator>
    <language>en</language>
    <lastBuildDate>Sun, 31 May 2020 21:30:28 +0800</lastBuildDate>
    <atom:link href="http://localhost:1313/tags/%E7%BF%BB%E8%AF%91/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>go string to byte</title>
      <link>http://localhost:1313/posts/go_string_byte/</link>
      <pubDate>Sun, 31 May 2020 21:30:28 +0800</pubDate>
      <guid>http://localhost:1313/posts/go_string_byte/</guid>
      <description>&lt;h2 id=&#34;0x01-背景&#34;&gt;0x01 背景&lt;/h2&gt;&#xA;&lt;p&gt;最近在review其他同学代码发现将 string转[]byte的时候，得到的[]byte的容量是会变的, 比如如下一段代码的输出是32&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;func&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;() {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#x9;&lt;span style=&#34;color:#a6e22e&#34;&gt;s1&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;:=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;abc&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#x9;&lt;span style=&#34;color:#a6e22e&#34;&gt;fmt&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;Println&lt;/span&gt;(cap([]byte(&lt;span style=&#34;color:#a6e22e&#34;&gt;s1&lt;/span&gt;)))&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;0x02-探究&#34;&gt;0x02 探究&lt;/h2&gt;&#xA;&lt;p&gt;那么这是为什么呢，首先看汇编&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;-N 禁止优化&#xA;-S 输出汇编代码&#xA;-l 禁止内联&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;go&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;build&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;gcflags&lt;/span&gt;=&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;-N -l -S&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;go&lt;/span&gt;.&lt;span style=&#34;color:#66d9ef&#34;&gt;go&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;得到以下代码&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;&amp;#34;&amp;#34;.main STEXT size=293 args=0x0 locals=0xc0&#xA;&#x9;0x0000 00000 (/home/xxx/go.go:5)&#x9;TEXT&#x9;&amp;#34;&amp;#34;.main(SB), ABIInternal, $192-0&#xA;&#x9;0x0000 00000 (/home/xxx/go.go:5)&#x9;MOVQ&#x9;(TLS), CX&#xA;&#x9;0x0009 00009 (/home/xxx/go.go:5)&#x9;LEAQ&#x9;-64(SP), AX&#xA;&#x9;0x000e 00014 (/home/xxx/go.go:5)&#x9;CMPQ&#x9;AX, 16(CX)&#xA;&#x9;0x0012 00018 (/home/xxx/go.go:5)&#x9;JLS&#x9;283&#xA;&#x9;0x0018 00024 (/home/xxx/go.go:5)&#x9;SUBQ&#x9;$192, SP&#xA;&#x9;0x001f 00031 (/home/xxx/go.go:5)&#x9;MOVQ&#x9;BP, 184(SP)&#xA;&#x9;0x0027 00039 (/home/xxx/go.go:5)&#x9;LEAQ&#x9;184(SP), BP&#xA;&#x9;0x002f 00047 (/home/xxx/go.go:5)&#x9;FUNCDATA&#x9;$0, gclocals·7d2d5fca80364273fb07d5820a76fef4(SB)&#xA;&#x9;0x002f 00047 (/home/xxx/go.go:5)&#x9;FUNCDATA&#x9;$1, gclocals·4dc9e0f0c3406fbbbbd2ec99068e8282(SB)&#xA;&#x9;0x002f 00047 (/home/xxx/go.go:5)&#x9;FUNCDATA&#x9;$2, gclocals·8dcadbff7c52509cfe2d26e4d7d24689(SB)&#xA;&#x9;0x002f 00047 (/home/xxx/go.go:5)&#x9;FUNCDATA&#x9;$3, &amp;#34;&amp;#34;.main.stkobj(SB)&#xA;&#x9;0x002f 00047 (/home/xxx/go.go:6)&#x9;PCDATA&#x9;$0, $1&#xA;&#x9;0x002f 00047 (/home/xxx/go.go:6)&#x9;PCDATA&#x9;$1, $0&#xA;&#x9;0x002f 00047 (/home/xxx/go.go:6)&#x9;LEAQ&#x9;go.string.&amp;#34;abc&amp;#34;(SB), AX&#xA;&#x9;0x0036 00054 (/home/xxx/go.go:6)&#x9;MOVQ&#x9;AX, &amp;#34;&amp;#34;.s1+104(SP)&#xA;&#x9;0x003b 00059 (/home/xxx/go.go:6)&#x9;MOVQ&#x9;$3, &amp;#34;&amp;#34;.s1+112(SP)&#xA;&#x9;0x0044 00068 (/home/xxx/go.go:7)&#x9;PCDATA&#x9;$0, $2&#xA;&#x9;0x0044 00068 (/home/xxx/go.go:7)&#x9;LEAQ&#x9;&amp;#34;&amp;#34;..autotmp_4+56(SP), CX&#xA;&#x9;0x0049 00073 (/home/xxx/go.go:7)&#x9;PCDATA&#x9;$0, $1&#xA;&#x9;0x0049 00073 (/home/xxx/go.go:7)&#x9;MOVQ&#x9;CX, (SP)&#xA;&#x9;0x004d 00077 (/home/xxx/go.go:7)&#x9;PCDATA&#x9;$0, $0&#xA;&#x9;0x004d 00077 (/home/xxx/go.go:7)&#x9;MOVQ&#x9;AX, 8(SP)&#xA;&#x9;0x0052 00082 (/home/xxx/go.go:7)&#x9;MOVQ&#x9;$3, 16(SP)&#xA;&#x9;0x005b 00091 (/home/xxx/go.go:7)&#x9;CALL&#x9;runtime.stringtoslicebyte(SB)&#xA;&#x9;0x0060 00096 (/home/xxx/go.go:7)&#x9;MOVQ&#x9;40(SP), AX&#xA;&#x9;0x0065 00101 (/home/xxx/go.go:7)&#x9;MOVQ&#x9;32(SP), CX&#xA;&#x9;0x006a 00106 (/home/xxx/go.go:7)&#x9;PCDATA&#x9;$0, $3&#xA;&#x9;0x006a 00106 (/home/xxx/go.go:7)&#x9;MOVQ&#x9;24(SP), DX&#xA;&#x9;0x006f 00111 (/home/xxx/go.go:7)&#x9;PCDATA&#x9;$0, $0&#xA;&#x9;0x006f 00111 (/home/xxx/go.go:7)&#x9;MOVQ&#x9;DX, &amp;#34;&amp;#34;..autotmp_2+160(SP)&#xA;&#x9;0x0077 00119 (/home/xxx/go.go:7)&#x9;MOVQ&#x9;CX, &amp;#34;&amp;#34;..autotmp_2+168(SP)&#xA;&#x9;0x007f 00127 (/home/xxx/go.go:7)&#x9;MOVQ&#x9;AX, &amp;#34;&amp;#34;..autotmp_2+176(SP)&#xA;&#x9;0x0087 00135 (/home/xxx/go.go:7)&#x9;MOVQ&#x9;AX, &amp;#34;&amp;#34;..autotmp_3+48(SP)&#xA;&#x9;0x008c 00140 (/home/xxx/go.go:7)&#x9;MOVQ&#x9;AX, (SP)&#xA;&#x9;0x0090 00144 (/home/xxx/go.go:7)&#x9;CALL&#x9;runtime.convT64(SB)&#xA;&#x9;0x0095 00149 (/home/xxx/go.go:7)&#x9;PCDATA&#x9;$0, $1&#xA;&#x9;0x0095 00149 (/home/xxx/go.go:7)&#x9;MOVQ&#x9;8(SP), AX&#xA;&#x9;0x009a 00154 (/home/xxx/go.go:7)&#x9;PCDATA&#x9;$0, $0&#xA;&#x9;0x009a 00154 (/home/xxx/go.go:7)&#x9;PCDATA&#x9;$1, $1&#xA;&#x9;0x009a 00154 (/home/xxx/go.go:7)&#x9;MOVQ&#x9;AX, &amp;#34;&amp;#34;..autotmp_5+96(SP)&#xA;&#x9;0x009f 00159 (/home/xxx/go.go:7)&#x9;PCDATA&#x9;$1, $2&#xA;&#x9;0x009f 00159 (/home/xxx/go.go:7)&#x9;XORPS&#x9;X0, X0&#xA;&#x9;0x00a2 00162 (/home/xxx/go.go:7)&#x9;MOVUPS&#x9;X0, &amp;#34;&amp;#34;..autotmp_1+120(SP)&#xA;&#x9;0x00a7 00167 (/home/xxx/go.go:7)&#x9;PCDATA&#x9;$0, $1&#xA;&#x9;0x00a7 00167 (/home/xxx/go.go:7)&#x9;PCDATA&#x9;$1, $1&#xA;&#x9;0x00a7 00167 (/home/xxx/go.go:7)&#x9;LEAQ&#x9;&amp;#34;&amp;#34;..autotmp_1+120(SP), AX&#xA;&#x9;0x00ac 00172 (/home/xxx/go.go:7)&#x9;MOVQ&#x9;AX, &amp;#34;&amp;#34;..autotmp_7+88(SP)&#xA;&#x9;0x00b1 00177 (/home/xxx/go.go:7)&#x9;TESTB&#x9;AL, (AX)&#xA;&#x9;0x00b3 00179 (/home/xxx/go.go:7)&#x9;PCDATA&#x9;$0, $2&#xA;&#x9;0x00b3 00179 (/home/xxx/go.go:7)&#x9;PCDATA&#x9;$1, $0&#xA;&#x9;0x00b3 00179 (/home/xxx/go.go:7)&#x9;MOVQ&#x9;&amp;#34;&amp;#34;..autotmp_5+96(SP), CX&#xA;&#x9;0x00b8 00184 (/home/xxx/go.go:7)&#x9;PCDATA&#x9;$0, $4&#xA;&#x9;0x00b8 00184 (/home/xxx/go.go:7)&#x9;LEAQ&#x9;type.int(SB), DX&#xA;&#x9;0x00bf 00191 (/home/xxx/go.go:7)&#x9;PCDATA&#x9;$0, $2&#xA;&#x9;0x00bf 00191 (/home/xxx/go.go:7)&#x9;MOVQ&#x9;DX, &amp;#34;&amp;#34;..autotmp_1+120(SP)&#xA;&#x9;0x00c4 00196 (/home/xxx/go.go:7)&#x9;PCDATA&#x9;$0, $1&#xA;&#x9;0x00c4 00196 (/home/xxx/go.go:7)&#x9;MOVQ&#x9;CX, &amp;#34;&amp;#34;..autotmp_1+128(SP)&#xA;&#x9;0x00cc 00204 (/home/xxx/go.go:7)&#x9;TESTB&#x9;AL, (AX)&#xA;&#x9;0x00ce 00206 (/home/xxx/go.go:7)&#x9;JMP&#x9;208&#xA;&#x9;0x00d0 00208 (/home/xxx/go.go:7)&#x9;MOVQ&#x9;AX, &amp;#34;&amp;#34;..autotmp_6+136(SP)&#xA;&#x9;0x00d8 00216 (/home/xxx/go.go:7)&#x9;MOVQ&#x9;$1, &amp;#34;&amp;#34;..autotmp_6+144(SP)&#xA;&#x9;0x00e4 00228 (/home/xxx/go.go:7)&#x9;MOVQ&#x9;$1, &amp;#34;&amp;#34;..autotmp_6+152(SP)&#xA;&#x9;0x00f0 00240 (/home/xxx/go.go:7)&#x9;PCDATA&#x9;$0, $0&#xA;&#x9;0x00f0 00240 (/home/xxx/go.go:7)&#x9;MOVQ&#x9;AX, (SP)&#xA;&#x9;0x00f4 00244 (/home/xxx/go.go:7)&#x9;MOVQ&#x9;$1, 8(SP)&#xA;&#x9;0x00fd 00253 (/home/xxx/go.go:7)&#x9;MOVQ&#x9;$1, 16(SP)&#xA;&#x9;0x0106 00262 (/home/xxx/go.go:7)&#x9;CALL&#x9;fmt.Println(SB)&#xA;&#x9;0x010b 00267 (/home/xxx/go.go:9)&#x9;MOVQ&#x9;184(SP), BP&#xA;&#x9;0x0113 00275 (/home/xxx/go.go:9)&#x9;ADDQ&#x9;$192, SP&#xA;&#x9;0x011a 00282 (/home/xxx/go.go:9)&#x9;RET&#xA;&#x9;0x011b 00283 (/home/xxx/go.go:9)&#x9;NOP&#xA;&#x9;0x011b 00283 (/home/xxx/go.go:5)&#x9;PCDATA&#x9;$1, $-1&#xA;&#x9;0x011b 00283 (/home/xxx/go.go:5)&#x9;PCDATA&#x9;$0, $-1&#xA;&#x9;0x011b 00283 (/home/xxx/go.go:5)&#x9;CALL&#x9;runtime.morestack_noctxt(SB)&#xA;&#x9;0x0120 00288 (/home/xxx/go.go:5)&#x9;JMP&#x9;0&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;声明部分&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
